# Лабораторная работа № 1 по дисциплине "Компьютерное зрение". 
(Магистратура, 1 курс)

## Вариант 11. Дилатация изображения

### Задание:
Задан примитив размера 3 на 3. На вход поступает изображение, программа отрисовывает окно, в которое выводится либо исходное изображение после бинаризации, либо после дилатации (переключение по нажатию клавиши).  
Базовый алгоритм (дилатация), используемый в программе, необходимо реализовать в 3 вариантах:
* с использованием встроенных функций какой-либо библиотеки - OpenCV, PIL и др. (файл opencv.py),
* нативно на Python (файл only_python.py),
* с использованием Numba или C++ (файл numba_jit.py).

### Теоретическая база
Дилатация и эрозия - две основные операции с изображениями в области математической морфологии.

Дилатация ("расширение", "наращивание") - это операция определения локального максимума по некоторой окрестности, которая задается структурообразующим элементом (ядром, kernel).

* Обычно применяется к бинарным изображениям, но возможна работа с изображениями в градациях серого. 
* Ядро может быть произвольной формы и размера.
* В ядре выделяется единственная ведущая позиция (anchor), которая совмещается с текущим пикселем при вычислении свертки.
* Фильтр дилатация увеличивает область изображения, расширяя его пиксели и тем самым способствуя объединению областей изображения, которые были разделены шумом и др.
* Изображение после фильтра становится светлее и слегка размытым. То есть темные детали ослабляются или вообще исчезают, что зависит от соотношения их размеров и яркостей с заданными параметрами фильтра.

<img src="https://github.com/smlrdk/ComputerVision_Lab1/blob/main/readme_img/example_dilate.png">
Пример применения дилатации к бинарному изображению

### Описание разработанной системы (алгоритмы, принципы работы, архитектура)

#### Этапы работы скриптов:
1. Загрузка изображения.
2. Преобразование изображения в градации серого.
3. Бинаризация изображения.
4. Дилатация изображения.
5. Вывод изображения после проведённых операций.

При запуске программы в окно "frame" выводится изображение после преобразования в градации серого и бинаризации. 
При нажатии клавиши 'd' происходит следующее:
* выполнение алгоритма дилатации бинарного изображения,
* вычисление затраченного времени на преобразование одного кадра видеопотока.

### Результаты работы и тестирования системы (скриншоты, изображения, графики, закономерности)

Пример дилатации, реализованной с помощью библиотеки OpenCV 
<img src="https://github.com/smlrdk/ComputerVision_Lab1/blob/main/readme_img/opencv_example.png" height="165" width="560">

Пример дилатации, реализованной с помощью нативного языка Python
<img src="https://github.com/smlrdk/ComputerVision_Lab1/blob/main/readme_img/only_python_example.png" height="165" width="560">

Пример дилатации, реализованной с помощью компилятора Numba
<img src="https://github.com/smlrdk/ComputerVision_Lab1/blob/main/readme_img/numba_jit_example.png" height="165" width="560">
https://github.com/smlrdk/ComputerVision_Lab1/blob/main/readme_img/numba_jit_example.png

### Выводы по работе

#### Время обработки одного кадра алгоритмом дилатации:
* OpenCV - 0.0007138252258300781
* Нативный Python - 2.404609441757202
* Numba - 0.589930534362793

В ходе выполнения работы было проведено сравнение трёх различных реализация алгоритма дилатация. Наилучший результат показала реализация с помощью функций библиотеки OpenCV, поскольку функции в библиотеки оптимизированы. На втором месте по скорости - JIT компиляция, поскольку он отлично справляется с циклами и повышает эффективность алгоритма. На третьем месте по скорости и эффективности - нативный Python. Это связано с тем, что циклы на Python - неэффективны в чистом виде. 

### Использованные источники
1. https://docs.opencv.org/3.4/d4/d86/group__imgproc__filter.html#gac342a1bb6eabf6f55c803b09268e36dc 
2. https://docs.opencv.org/4.x/d7/d4d/tutorial_py_thresholding.html
3. https://docs.opencv.org/3.4/d4/d76/tutorial_js_morphological_ops.html
4. http://altamisoft.ru/products/altami_studio/user_manual_AS_3_1_0/filters/morphological_operations/dilate/
5. https://towardsdatascience.com/image-processing-part-3-dbf103622909 