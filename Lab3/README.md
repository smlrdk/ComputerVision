# Лабораторная работа № 3 по дисциплине "Компьютерное зрение" 
(Солодкая Мария, магистратура, 1 курс)

## Задание:
Необходимо реализовать простейшую систему классификации изображений на основе сверточных нейронных сетей. Возможно использовать любые
доступные технологии, рекомендованный список такой: Google Colab для запуска (можно другую платформу или локальную машину), PyTorch, Torchvision.

Система должна загружать изображение с диска, преобразовывать в нужный для обработки моделью нейронной сети формат (тензор), выполнять
предобработку, если требуется (например, изменение размера и нормирование), затем обрабатывать с помощью нейронной сети и выводить
результат (номер класса, название, его вероятность для первых 5 наиболее вероятных классов).

Необходимо провести исследование по сравнению эффективности трех разных архитектур (можно использовать предобученные модели из
torchvision.models https://pytorch.org/vision/stable/models.html, например, AlexNet, VGG16, ResNet50). Нужно узнать, на каком датасете предобучены данные модели (использовать веса, полученные с одного и того же набора) и найти список классов, которые они предсказывают. Каждую модель необходимо протестировать на вашем собственном наборе из не менее чем 50 изображений (можно использовать любые изображения, но не те, которые использовались для обучения), в качестве метрик использовать top-1 accuracy и top-5 accuracy. В данной работе не требуется проводить обучение нейронной сети (только по желанию).

## Теоретическая база
**AlexNet**

В 2012 году сверточная нейронная сеть с архитектурой AlexNet смогла обогнать своих предшественников. Её основное отличие состоит в том, что у неё больше фильтров на слое и вложенных сверточных слоев, а также:

* В качестве функции активации вместо привычного Tanh используется ReLU, что способствует увеличению скорости.
* Для борьбы с переобучением вместо регуляризации используется дропаут.

Сеть состоит из 5 уровней Convolutional (CONV) и 3 уровней Fully Connected (FC). Используемая активация - выпрямленная линейная единица (ReLU). 

<img src="https://github.com/smlrdk/ComputerVision/blob/main/Lab3/readme_img/alexnet.png">

*Архитектура AlexNet* 

**ResNet**

Resnet18 имеет около 11 миллионов обучаемых параметров. Он состоит из слоев CONV с фильтрами размером 3х3 (как и в VGGNet). В сети используются только два уровня пула: один в начале, а другой в конце сети. Идентификационные связи находятся между каждыми двумя слоями CONV. Сплошные стрелки показывают ярлыки идентификаторов, где размеры входа и выхода одинаковы, а пунктирные обозначают проекционные соединения, где размеры отличаются. 

<img src="https://github.com/smlrdk/ComputerVision/blob/main/Lab3/readme_img/ResNet.png">

*Архитектура ResNet* 

**VGG16**

Существует несколько вариантов VGGNet (VGG16, VGG19 и т. Д.), Которые отличаются только общим количеством слоев в сети.

VGG16 имеет в общей сложности 138 миллионов параметров. Здесь важно отметить, что все ядра conv имеют размер 3x3, а ядра maxpool - 2x2 с шагом два.

<img src="https://github.com/smlrdk/ComputerVision/blob/main/Lab3/readme_img/VGG.png">

*Архитектура VGG* 

## Описание разработанной системы

### Файлы
* В файлах AlexNet.ipynb, ResNet50.ipynb, VGG19.ipynb представлен полный вывод результатов работы модели: изображения с первыми 5-тью наиболее вероятными классами для предмета на изображении и подсчет Top-5 и Top-1 accuracy.

* В файле sulition.ipynb представлен тот же код, что и в файлах упомянутых выше, но более кратко, а также в выводе представлен только подсчет Top-5 и Top-1 accuracy.

* В файле imagenet_classes.txt приведены сведения о всех существующих классах в ImageNet.

### Датасет

**Датасет состоит из 50 изображений следующих классов ImageNet:**
* African elephant
* Indian elephant
* airliner
* lemon
* dalmatian
* Pomeranian
* golden retriever
* collie
* dingo
* basenji
* tabby
* Samoyed
* mobile home
* koala
* abacus
* carton
* library

### Принцип работы состоит из пяти этапов:
1. Создание датасета.
2. Импорт библиотек.
3. Инициализация модели.
4. Инициализиция препроцессинга.
5. Использование препроцессинга для изображения.
6. Предсказывание класса предмета из изображения с помощью модели.
7. Вывод изображения с первыми 5-тью наиболее вероятными классами для предмета на изображении.

## Результаты работы и тестирования системы

Результаты взяты из файла solution.ipynb

| Архитектура | Top-1 accuracy | Top-5 accuracy | Time   | 
|-------------|----------------|----------------|--------|
| AlexNet     |      84 %      |     64 %       |15.2 s  |
| ResNet50    |      90 %      |     80 %       |45.2 s  |
| VGG19       |      88 %      |     82 %       |1min 22s|

## Выводы по работе

В ходе выполнения лабораторной работы была реализована система классификации изображений с использованием трех типов сверточных нейронных сетей:
* AlexNet;
* ResNet50;
* VGG19.

AlexNet быстрее всех справился с классификацией изображений, но продемонстрировал самую низкую accuracy, как топ-5, так и топ-1.

ResNet50 практически в 3 раза дольше классифицировал датасет из 50 изображений, чем AlexNet, но продемонстрировал самый высокий процент точности топ-5.  

VGG19 дольше всех классифицировал изображения. По точности топ-5 он не сильно отстает от ResNet50, всего на 2%. При неоднократном запуске программного кода, посвященного классификации изображений с помощью VGG19, были случаи, когда VGG19 по точности топ-5 уходил вперед на 1-2% от точности топ-5 ResNet50.

В то же время, по точности топ-1 лучше всех справилась модель VGG19.

Таким образом, можно сделать вывод: VGG19 и ResNet50 рекомендуется использовать в том случае, если есть возможность использовать больше памяти, а также больше времени. 

## Использованные источники
1. https://pytorch.org/vision/stable/models.html 
2. https://towardsdatascience.com/the-w3h-of-alexnet-vggnet-resnet-and-inception-7baaaecccc96 